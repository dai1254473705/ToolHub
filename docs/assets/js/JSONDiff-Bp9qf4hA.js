import{r as e}from"./rolldown-runtime-Dyt8byMj.js";import{C as s,E as n,G as i,N as r,b as l,m as a,n as t,s as c}from"./react-oMMneaen.js";import{E as d,a as o,j as f,w as u}from"./vendor-DIW1e2QO.js";var j=e(i()),m=e(t()),{Title:x}=c,N=()=>{const[e,i]=(0,j.useState)(""),[t,c]=(0,j.useState)(""),[N,h]=(0,j.useState)([]),[p,v]=(0,j.useState)([]),[S,g]=(0,j.useState)(null),[O,y]=(0,j.useState)(null),[J,b]=(0,j.useState)(!1),C=(0,j.useRef)(null),k=(0,j.useRef)(null),R=(0,j.useRef)(null),w=(0,j.useRef)(null),E=e=>{if(!e.trim())return{isValid:!1,formatted:""};try{const s=JSON.parse(e);return{isValid:!0,formatted:JSON.stringify(s,null,2)}}catch{return{isValid:!1,formatted:""}}};(0,j.useEffect)(()=>{if(!e.trim())return g(null),void b(!1);const s=E(e);g(s.isValid),b(!1)},[e]),(0,j.useEffect)(()=>{if(!t.trim())return y(null),void b(!1);const e=E(t);y(e.isValid),b(!1)},[t]);const V=(e,s)=>{if(!e)return;const n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)},D=(e,s)=>{const n=e.target.files?.[0];if(!n)return;const i=new FileReader;i.onload=e=>{const n=e.target?.result;s(n)},i.readAsText(n),e.target&&(e.target.value="")},L=e=>{e.current&&e.current.click()};return(0,m.jsxs)("div",{className:"json-diff-container",children:[(0,m.jsx)(x,{level:4,children:"JSON对比工具"}),(0,m.jsx)("div",{className:"json-diff-controls",children:(0,m.jsx)(r,{type:"primary",icon:(0,m.jsx)(u,{}),onClick:()=>{if(e.trim()&&t.trim())if(!0===S&&!0===O)try{const s=JSON.parse(e),n=JSON.parse(t),i=JSON.stringify(s,null,2),r=JSON.stringify(n,null,2),l=i.split("\n"),c=r.split("\n"),d=l.map((e,s)=>({line:e,isDifferent:c[s]!==e,lineNumber:s+1})),o=c.map((e,s)=>({line:e,isDifferent:l[s]!==e,lineNumber:s+1}));h(d),v(o),b(!0),a.success("JSON对比完成")}catch(s){a.error(`对比过程中发生错误: ${s instanceof Error?s.message:"未知错误"}`)}else a.error("请确保两侧的JSON格式正确");else a.warning("请在两侧都输入JSON内容")},disabled:!0!==S||!0!==O,children:"对比JSON"})}),(0,m.jsxs)("div",{className:"json-diff-grid",children:[(0,m.jsxs)(n,{title:"JSON 左侧",extra:(0,m.jsxs)(l,{children:[(0,m.jsx)(r,{icon:(0,m.jsx)(f,{}),onClick:()=>{i(""),g(null),b(!1),C.current&&C.current.focus()},children:"清除"}),(0,m.jsx)(r,{icon:(0,m.jsx)(o,{}),onClick:()=>L(R),children:"上传"}),(0,m.jsx)(r,{icon:(0,m.jsx)(d,{}),onClick:()=>V(e,"left.json"),disabled:!e,children:"下载"}),(0,m.jsx)("input",{ref:R,type:"file",accept:".json",style:{display:"none"},onChange:e=>D(e,i)})]}),className:!1===S?"error-card":"",children:[(0,m.jsx)("textarea",{ref:C,value:e,onChange:e=>i(e.target.value),placeholder:"请在此粘贴左侧JSON内容...",className:"json-input"}),!1===S&&(0,m.jsx)("div",{className:"error-message",children:"JSON格式错误，请检查输入内容"})]}),(0,m.jsx)(s,{type:"vertical",className:"divider"}),(0,m.jsxs)(n,{title:"JSON 右侧",extra:(0,m.jsxs)(l,{children:[(0,m.jsx)(r,{icon:(0,m.jsx)(f,{}),onClick:()=>{c(""),y(null),b(!1),k.current&&k.current.focus()},children:"清除"}),(0,m.jsx)(r,{icon:(0,m.jsx)(o,{}),onClick:()=>L(w),children:"上传"}),(0,m.jsx)(r,{icon:(0,m.jsx)(d,{}),onClick:()=>V(t,"right.json"),disabled:!t,children:"下载"}),(0,m.jsx)("input",{ref:w,type:"file",accept:".json",style:{display:"none"},onChange:e=>D(e,c)})]}),className:!1===O?"error-card":"",children:[(0,m.jsx)("textarea",{ref:k,value:t,onChange:e=>c(e.target.value),placeholder:"请在此粘贴右侧JSON内容...",className:"json-input"}),!1===O&&(0,m.jsx)("div",{className:"error-message",children:"JSON格式错误，请检查输入内容"})]})]}),J&&(0,m.jsxs)("div",{className:"json-diff-results",children:[(0,m.jsx)(x,{level:5,children:"对比结果"}),(0,m.jsxs)("div",{className:"json-diff-results-grid",children:[(0,m.jsx)(n,{title:"左侧对比结果",className:"diff-result-card",children:(0,m.jsx)("div",{className:"diff-result-content",children:N.map((e,s)=>(0,m.jsxs)("div",{className:"diff-line "+(e.isDifferent?"diff-different":"diff-same"),children:[(0,m.jsx)("span",{className:"line-number",children:e.lineNumber}),(0,m.jsx)("span",{className:"line-content",children:e.line})]},s))})}),(0,m.jsx)(s,{type:"vertical",className:"divider"}),(0,m.jsx)(n,{title:"右侧对比结果",className:"diff-result-card",children:(0,m.jsx)("div",{className:"diff-result-content",children:p.map((e,s)=>(0,m.jsxs)("div",{className:"diff-line "+(e.isDifferent?"diff-different":"diff-same"),children:[(0,m.jsx)("span",{className:"line-number",children:e.lineNumber}),(0,m.jsx)("span",{className:"line-content",children:e.line})]},s))})})]})]})]})};export{N as default};