import{i as e}from"./rolldown-runtime-tH7qxucP.js";import{G as t,O as s,T as r,i as o,n,p as a,r as l,x as i,z as c}from"./antd-DHjKV_bb.js";import{C as d,E as u,T as m}from"./react-DF9HAzp0.js";import{E as j,o as p}from"./vendor-C33QSf7L.js";import"./monaco-BXQFBSl2.js";var f=e(t()),x=e(m()),{Title:h}=l,y=()=>{const{t:e}=u(),[t,l]=(0,f.useState)(""),[m,y]=(0,f.useState)(""),[v,g]=(0,f.useState)(null),N=(0,f.useRef)(null),E=(0,f.useRef)(null);(0,f.useEffect)(()=>{if(!t.trim())return g(null),void y("");try{const e=JSON.parse(t),s=JSON.stringify(e,null,2);y(s),g(!0)}catch(e){g(!1),a.error(`JSON解析错误: ${e instanceof Error?e.message:"未知错误"}`)}},[t]);(0,f.useEffect)(()=>{if(!t.trim())return y(""),void g(null);try{const e=JSON.parse(t),s=JSON.stringify(e,null,2);y(s),g(!0)}catch{g(!1)}},[t]);return(0,x.jsxs)("div",{className:"json-editor-container",children:[(0,x.jsx)(h,{level:4,children:e("tools.jsonEditor.title")}),(0,x.jsxs)("div",{className:"json-editor-grid",children:[(0,x.jsxs)(s,{title:e("tools.jsonEditor.input.title"),extra:(0,x.jsxs)(i,{children:[(0,x.jsx)(c,{type:!0===v?"primary":"default",icon:(0,x.jsx)(j,{}),onClick:()=>{l(""),y(""),g(null),N.current&&N.current.focus()},children:e("common.clear")}),(0,x.jsx)(c,{type:"primary",icon:(0,x.jsx)(p,{}),onClick:()=>{E.current&&E.current.click()},children:e("common.upload")}),(0,x.jsx)("input",{ref:E,type:"file",accept:".json",style:{display:"none"},onChange:e=>{const t=e.target.files?.[0];if(!t)return;const s=new FileReader;s.onload=e=>{const t=e.target?.result;l(t);try{const e=JSON.parse(t),s=JSON.stringify(e,null,2);y(s),g(!0)}catch{g(!1)}},s.readAsText(t),e.target&&(e.target.value="")}})]}),className:!1===v?"error-card":"",children:[(0,x.jsx)("textarea",{ref:N,value:t,onChange:e=>l(e.target.value),placeholder:e("tools.jsonEditor.input.placeholder"),className:"json-input"}),!1===v&&(0,x.jsx)("div",{className:"error-message",children:e("tools.jsonEditor.messages.formatError")})]}),(0,x.jsx)(r,{type:"vertical",className:"divider"}),(0,x.jsx)(s,{title:e("tools.jsonEditor.output.title"),extra:(0,x.jsxs)(i,{children:[(0,x.jsx)(c,{icon:(0,x.jsx)(o,{}),onClick:()=>{m&&navigator.clipboard.writeText(m).then(()=>{a.success(e("common.copied"))})},disabled:!m,children:e("common.copy")}),(0,x.jsx)(c,{icon:(0,x.jsx)(n,{}),onClick:()=>{if(!m)return;const e=new Blob([m],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="formatted.json",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},disabled:!m,children:e("common.download")})]}),className:"preview-card",children:m?(0,x.jsx)(d,{height:"400px",defaultLanguage:"json",value:m,options:{readOnly:!0,minimap:{enabled:!0},lineNumbers:"on",scrollBeyondLastLine:!1,fontSize:14,theme:"vs-light"}}):(0,x.jsx)("div",{className:"empty-state",children:e("tools.jsonEditor.output.placeholder")})})]})]})};export{y as default};