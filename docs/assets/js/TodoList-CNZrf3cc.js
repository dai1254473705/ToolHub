import{i as t}from"./rolldown-runtime-tH7qxucP.js";import{A as e,F as o,G as s,N as i,O as r,R as l,a,c as d,d as n,f as c,g as m,k as p,m as h,o as x,r as u,v as j,x as g,z as y}from"./antd-DHjKV_bb.js";import{E as f,T as L}from"./react-DF9HAzp0.js";import{D as w,T as b,a as v}from"./vendor-C33QSf7L.js";var N=t(s());let D=function(t){return t.LOW="low",t.MEDIUM="medium",t.HIGH="high",t}({});var I=t(L()),{Text:C,Paragraph:E}=u,T=({todo:t,onToggleComplete:e,onEdit:o,onDelete:s})=>{const{t:i}=f();return(0,I.jsx)(r,{className:"todo-item-card mb-4 hover:shadow-md transition-shadow "+(t.completed?"opacity-70":""),extra:(0,I.jsxs)(g,{size:"small",children:[(0,I.jsx)(y,{type:"text",icon:t.completed?(0,I.jsx)(b,{}):(0,I.jsx)(w,{}),onClick:()=>e(t.id),title:t.completed?i("tools.todoList.item.markUncomplete"):i("tools.todoList.item.markComplete")}),(0,I.jsx)(y,{type:"text",icon:(0,I.jsx)(a,{}),onClick:()=>o(t),title:i("tools.todoList.item.edit")}),(0,I.jsx)(n,{title:i("tools.todoList.item.deleteConfirm"),onConfirm:()=>s(t.id),okText:i("common.confirm"),cancelText:i("common.cancel"),children:(0,I.jsx)(y,{type:"text",danger:!0,icon:(0,I.jsx)(x,{}),title:i("tools.todoList.item.delete")})})]}),children:(0,I.jsx)("div",{className:"flex items-start justify-between",children:(0,I.jsxs)("div",{className:"flex-1",children:[(0,I.jsxs)("div",{className:"flex items-center mb-2",children:[(0,I.jsx)(C,{strong:!0,className:t.completed?"line-through":"",children:t.title}),(0,I.jsx)(d,{color:(t=>{switch(t){case D.HIGH:return"red";case D.MEDIUM:return"orange";case D.LOW:return"green";default:return"blue"}})(t.priority),className:"ml-2",children:(t=>{switch(t){case D.HIGH:return i("tools.todoList.form.priorities.high");case D.MEDIUM:return i("tools.todoList.form.priorities.medium");case D.LOW:return i("tools.todoList.form.priorities.low");default:return i("tools.todoList.form.priorities.medium")}})(t.priority)})]}),t.description&&(0,I.jsx)(E,{className:"mb-2 "+(t.completed?"line-through":""),children:t.description}),(0,I.jsxs)(C,{type:"secondary",className:"text-xs",children:[i("tools.todoList.item.created"),new Date(t.createdAt).toLocaleString()]}),t.updatedAt!==t.createdAt&&(0,I.jsxs)(C,{type:"secondary",className:"text-xs ml-2",children:[i("tools.todoList.item.updated"),new Date(t.updatedAt).toLocaleString()]})]})})})},{TextArea:k}=m,{Option:A}=o,F=({visible:t,todo:e,onCancel:s,onSubmit:i})=>{const{t:r}=f(),[l]=j.useForm();N.useEffect(()=>{t&&(e?l.setFieldsValue({title:e.title,description:e.description,priority:e.priority}):l.resetFields())},[t,e,l]);return(0,I.jsx)(c,{title:r(e?"tools.todoList.edit":"tools.todoList.add"),open:t,onCancel:s,footer:null,children:(0,I.jsxs)(j,{form:l,layout:"vertical",className:"mt-2",children:[(0,I.jsx)(j.Item,{name:"title",label:r("tools.todoList.form.title"),rules:[{required:!0,message:r("tools.todoList.form.required")}],children:(0,I.jsx)(m,{placeholder:r("tools.todoList.form.titlePlaceholder")})}),(0,I.jsx)(j.Item,{name:"description",label:r("tools.todoList.form.desc"),children:(0,I.jsx)(k,{rows:4,placeholder:r("tools.todoList.form.descPlaceholder")})}),(0,I.jsx)(j.Item,{name:"priority",label:r("tools.todoList.form.priority"),initialValue:D.MEDIUM,rules:[{required:!0,message:r("tools.todoList.form.priorityPlaceholder")}],children:(0,I.jsxs)(o,{placeholder:r("tools.todoList.form.priorityPlaceholder"),children:[(0,I.jsx)(A,{value:D.LOW,children:r("tools.todoList.form.priorities.low")}),(0,I.jsx)(A,{value:D.MEDIUM,children:r("tools.todoList.form.priorities.medium")}),(0,I.jsx)(A,{value:D.HIGH,children:r("tools.todoList.form.priorities.high")})]})}),(0,I.jsxs)(j.Item,{className:"text-right",children:[(0,I.jsx)(y,{onClick:s,className:"mr-2",children:r("common.cancel")}),(0,I.jsx)(y,{type:"primary",onClick:()=>{l.validateFields().then(t=>{i(t),l.resetFields()})},children:r(e?"tools.todoList.update":"tools.todoList.add")})]})]})})},M=t(v());M.default.config({name:"ToolHub",storeName:"todolist"});var S="todo_items";const H=async()=>{try{return await M.default.getItem(S)||[]}catch(t){return console.error("Error getting todos:",t),[]}},O=async(t,e)=>{try{const o=await H(),s=o.findIndex(e=>e.id===t);return-1===s?null:(o[s]={...o[s],...e,updatedAt:new Date},await M.default.setItem(S,o),o[s])}catch(o){throw console.error("Error updating todo:",o),o}};var{Title:P}=u,{TabPane:U}=p,z=()=>{const{t:t}=f(),[o,s]=(0,N.useState)([]),[r,a]=(0,N.useState)(!0),[d,n]=(0,N.useState)(!1),[c,m]=(0,N.useState)(void 0),[x,u]=(0,N.useState)("all"),j=async()=>{a(!0);try{const t=await H();t.sort((t,e)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),s(t)}catch(t){console.error("Failed to load todos:",t)}finally{a(!1)}};(0,N.useEffect)(()=>{j()},[]);const L=async t=>{try{await(async t=>{try{const e=await H(),o=e.filter(e=>e.id!==t);return e.length!==o.length&&(await M.default.setItem(S,o),!0)}catch(e){throw console.error("Error deleting todo:",e),e}})(t),await j()}catch(e){console.error("Failed to delete todo:",e)}},w=async t=>{try{const e=o.find(e=>e.id===t);e&&(await O(t,{completed:!e.completed}),await j())}catch(e){console.error("Failed to toggle todo status:",e)}},b=t=>{m(t),n(!0)},v=o.filter(t=>"all"===x||("completed"===x?t.completed:"pending"!==x||!t.completed)),D=o.length,C=o.filter(t=>t.completed).length,E=D-C;return(0,I.jsxs)("div",{className:"todo-list-page",children:[(0,I.jsxs)("div",{className:"mb-6",children:[(0,I.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,I.jsx)(P,{level:2,children:t("tools.todoList.title")}),(0,I.jsx)(y,{type:"primary",icon:(0,I.jsx)(e,{}),onClick:()=>n(!0),children:t("tools.todoList.add")})]}),(0,I.jsxs)(g,{className:"mb-4",children:[(0,I.jsx)(i,{count:D,children:(0,I.jsx)("span",{className:"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800",children:t("tools.todoList.total")})}),(0,I.jsx)(i,{count:E,color:"blue",children:(0,I.jsx)("span",{className:"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800",children:t("tools.todoList.pending")})}),(0,I.jsx)(i,{count:C,color:"green",children:(0,I.jsx)("span",{className:"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800",children:t("tools.todoList.completed")})})]})]}),(0,I.jsxs)(p,{activeKey:x,onChange:u,className:"mb-4",children:[(0,I.jsx)(U,{tab:t("tools.todoList.tabs.all"),children:r?(0,I.jsx)("div",{className:"text-center py-10",children:(0,I.jsx)(h,{size:"large"})}):0===v.length?(0,I.jsx)(l,{description:t("tools.todoList.empty.all")}):(0,I.jsx)("div",{className:"todo-items-list",children:v.map(t=>(0,I.jsx)(T,{todo:t,onToggleComplete:w,onEdit:b,onDelete:L},t.id))})},"all"),(0,I.jsx)(U,{tab:t("tools.todoList.tabs.pending"),children:r?(0,I.jsx)("div",{className:"text-center py-10",children:(0,I.jsx)(h,{size:"large"})}):0===v.length?(0,I.jsx)(l,{description:t("tools.todoList.empty.pending")}):(0,I.jsx)("div",{className:"todo-items-list",children:v.map(t=>(0,I.jsx)(T,{todo:t,onToggleComplete:w,onEdit:b,onDelete:L},t.id))})},"pending"),(0,I.jsx)(U,{tab:t("tools.todoList.tabs.completed"),children:r?(0,I.jsx)("div",{className:"text-center py-10",children:(0,I.jsx)(h,{size:"large"})}):0===v.length?(0,I.jsx)(l,{description:t("tools.todoList.empty.completed")}):(0,I.jsx)("div",{className:"todo-items-list",children:v.map(t=>(0,I.jsx)(T,{todo:t,onToggleComplete:w,onEdit:b,onDelete:L},t.id))})},"completed")]}),(0,I.jsx)(F,{visible:d,todo:c,onCancel:()=>{n(!1),m(void 0)},onSubmit:c?async t=>{if(c)try{await O(c.id,t),await j(),n(!1),m(void 0)}catch(e){console.error("Failed to update todo:",e)}}:async t=>{try{await(async t=>{try{const e=await H(),o={...t,id:Date.now().toString(),completed:!1,createdAt:new Date,updatedAt:new Date};return e.push(o),await M.default.setItem(S,e),o}catch(e){throw console.error("Error adding todo:",e),e}})(t),await j(),n(!1)}catch(e){console.error("Failed to add todo:",e)}}})]})};export{z as default};