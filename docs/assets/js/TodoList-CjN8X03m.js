import{r as e}from"./rolldown-runtime-Dyt8byMj.js";import{A as t,D as s,E as a,G as r,M as l,N as o,_ as i,b as n,f as c,h as d,j as m,l as x,n as h,p,s as j,v as u}from"./react-BUTozKD7.js";import{A as g,D as y,M as w,T as f,i as v,p as b}from"./vendor-D3PduJC8.js";var N=e(r());let D=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e}({});var I=e(h()),{Text:E,Paragraph:C}=j,T=({todo:e,onToggleComplete:t,onEdit:s,onDelete:r})=>(0,I.jsx)(a,{className:"todo-item-card mb-4 hover:shadow-md transition-shadow "+(e.completed?"opacity-70":""),extra:(0,I.jsxs)(n,{size:"small",children:[(0,I.jsx)(o,{type:"text",icon:e.completed?(0,I.jsx)(g,{}):(0,I.jsx)(w,{}),onClick:()=>t(e.id),title:e.completed?"标记为未完成":"标记为已完成"}),(0,I.jsx)(o,{type:"text",icon:(0,I.jsx)(f,{}),onClick:()=>s(e),title:"编辑任务"}),(0,I.jsx)(c,{title:"确定要删除这个任务吗？",onConfirm:()=>r(e.id),okText:"确定",cancelText:"取消",children:(0,I.jsx)(o,{type:"text",danger:!0,icon:(0,I.jsx)(y,{}),title:"删除任务"})})]}),children:(0,I.jsx)("div",{className:"flex items-start justify-between",children:(0,I.jsxs)("div",{className:"flex-1",children:[(0,I.jsxs)("div",{className:"flex items-center mb-2",children:[(0,I.jsx)(E,{strong:!0,className:e.completed?"line-through":"",children:e.title}),(0,I.jsx)(x,{color:(e=>{switch(e){case D.HIGH:return"red";case D.MEDIUM:return"orange";case D.LOW:return"green";default:return"blue"}})(e.priority),className:"ml-2",children:(e=>{switch(e){case D.HIGH:return"高优先级";case D.MEDIUM:return"中优先级";case D.LOW:return"低优先级";default:return"普通"}})(e.priority)})]}),e.description&&(0,I.jsx)(C,{className:"mb-2 "+(e.completed?"line-through":""),children:e.description}),(0,I.jsxs)(E,{type:"secondary",className:"text-xs",children:["创建时间：",new Date(e.createdAt).toLocaleString()]}),e.updatedAt!==e.createdAt&&(0,I.jsxs)(E,{type:"secondary",className:"text-xs ml-2",children:["更新时间：",new Date(e.updatedAt).toLocaleString()]})]})})}),{TextArea:A}=i,{Option:M}=m,F=({visible:e,todo:t,onCancel:s,onSubmit:a})=>{const[r]=u.useForm();N.useEffect(()=>{e&&(t?r.setFieldsValue({title:t.title,description:t.description,priority:t.priority}):r.resetFields())},[e,t,r]);return(0,I.jsx)(p,{title:t?"编辑任务":"添加任务",open:e,onCancel:s,footer:null,children:(0,I.jsxs)(u,{form:r,layout:"vertical",className:"mt-2",children:[(0,I.jsx)(u.Item,{name:"title",label:"任务标题",rules:[{required:!0,message:"请输入任务标题"}],children:(0,I.jsx)(i,{placeholder:"请输入任务标题"})}),(0,I.jsx)(u.Item,{name:"description",label:"任务详情",children:(0,I.jsx)(A,{rows:4,placeholder:"请输入任务详情（可选）"})}),(0,I.jsx)(u.Item,{name:"priority",label:"优先级",initialValue:D.MEDIUM,rules:[{required:!0,message:"请选择优先级"}],children:(0,I.jsxs)(m,{placeholder:"请选择优先级",children:[(0,I.jsx)(M,{value:D.LOW,children:"低优先级"}),(0,I.jsx)(M,{value:D.MEDIUM,children:"中优先级"}),(0,I.jsx)(M,{value:D.HIGH,children:"高优先级"})]})}),(0,I.jsxs)(u.Item,{className:"text-right",children:[(0,I.jsx)(o,{onClick:s,className:"mr-2",children:"取消"}),(0,I.jsx)(o,{type:"primary",onClick:()=>{r.validateFields().then(e=>{a(e),r.resetFields()})},children:t?"更新":"添加"})]})]})})},S=e(v());S.default.config({name:"ToolHub",storeName:"todolist"});var k="todo_items";const H=async()=>{try{return await S.default.getItem(k)||[]}catch(e){return console.error("Error getting todos:",e),[]}},L=async(e,t)=>{try{const s=await H(),a=s.findIndex(t=>t.id===e);return-1===a?null:(s[a]={...s[a],...t,updatedAt:new Date},await S.default.setItem(k,s),s[a])}catch(s){throw console.error("Error updating todo:",s),s}};var{Title:G}=j,{TabPane:O}=s,U=()=>{const[e,a]=(0,N.useState)([]),[r,i]=(0,N.useState)(!0),[c,m]=(0,N.useState)(!1),[x,h]=(0,N.useState)(void 0),[p,j]=(0,N.useState)("all"),u=async()=>{i(!0);try{const e=await H();e.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),a(e)}catch(e){console.error("Failed to load todos:",e)}finally{i(!1)}};(0,N.useEffect)(()=>{u()},[]);const g=async e=>{try{await(async e=>{try{const t=await H(),s=t.filter(t=>t.id!==e);return t.length!==s.length&&(await S.default.setItem(k,s),!0)}catch(t){throw console.error("Error deleting todo:",t),t}})(e),await u()}catch(t){console.error("Failed to delete todo:",t)}},y=async t=>{try{const s=e.find(e=>e.id===t);s&&(await L(t,{completed:!s.completed}),await u())}catch(s){console.error("Failed to toggle todo status:",s)}},w=e=>{h(e),m(!0)},f=e.filter(e=>"all"===p||("completed"===p?e.completed:"pending"!==p||!e.completed)),v=e.length,D=e.filter(e=>e.completed).length,E=v-D;return(0,I.jsxs)("div",{className:"todo-list-page",children:[(0,I.jsxs)("div",{className:"mb-6",children:[(0,I.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,I.jsx)(G,{level:2,children:"任务管理"}),(0,I.jsx)(o,{type:"primary",icon:(0,I.jsx)(b,{}),onClick:()=>m(!0),children:"添加任务"})]}),(0,I.jsxs)(n,{className:"mb-4",children:[(0,I.jsx)(t,{count:v,children:(0,I.jsx)("span",{className:"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800",children:"总任务数"})}),(0,I.jsx)(t,{count:E,color:"blue",children:(0,I.jsx)("span",{className:"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800",children:"待完成"})}),(0,I.jsx)(t,{count:D,color:"green",children:(0,I.jsx)("span",{className:"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800",children:"已完成"})})]})]}),(0,I.jsxs)(s,{activeKey:p,onChange:j,className:"mb-4",children:[(0,I.jsx)(O,{tab:"全部任务",children:r?(0,I.jsx)("div",{className:"text-center py-10",children:(0,I.jsx)(d,{size:"large"})}):0===f.length?(0,I.jsx)(l,{description:"暂无任务"}):(0,I.jsx)("div",{className:"todo-items-list",children:f.map(e=>(0,I.jsx)(T,{todo:e,onToggleComplete:y,onEdit:w,onDelete:g},e.id))})},"all"),(0,I.jsx)(O,{tab:"待完成",children:r?(0,I.jsx)("div",{className:"text-center py-10",children:(0,I.jsx)(d,{size:"large"})}):0===f.length?(0,I.jsx)(l,{description:"暂无待完成任务"}):(0,I.jsx)("div",{className:"todo-items-list",children:f.map(e=>(0,I.jsx)(T,{todo:e,onToggleComplete:y,onEdit:w,onDelete:g},e.id))})},"pending"),(0,I.jsx)(O,{tab:"已完成",children:r?(0,I.jsx)("div",{className:"text-center py-10",children:(0,I.jsx)(d,{size:"large"})}):0===f.length?(0,I.jsx)(l,{description:"暂无已完成任务"}):(0,I.jsx)("div",{className:"todo-items-list",children:f.map(e=>(0,I.jsx)(T,{todo:e,onToggleComplete:y,onEdit:w,onDelete:g},e.id))})},"completed")]}),(0,I.jsx)(F,{visible:c,todo:x,onCancel:()=>{m(!1),h(void 0)},onSubmit:x?async e=>{if(x)try{await L(x.id,e),await u(),m(!1),h(void 0)}catch(t){console.error("Failed to update todo:",t)}}:async e=>{try{await(async e=>{try{const t=await H(),s={...e,id:Date.now().toString(),completed:!1,createdAt:new Date,updatedAt:new Date};return t.push(s),await S.default.setItem(k,t),s}catch(t){throw console.error("Error adding todo:",t),t}})(e),await u(),m(!1)}catch(t){console.error("Failed to add todo:",t)}}})]})};export{U as default};